### Q1
package main

var currentUserID string

func LoginHandler(w http.ResponseWriter, r *http.Request) {
	// ログイン処理の一部としてユーザーIDをセット
	currentUserID = r.URL.Query().Get("user_id")
	fmt.Fprintf(w, "User %s logged in\n", currentUserID)
}

### A
グローバル変数はスレッドセーフでないため、リクエストのユーザーIDの上書きを避けるためにコンテキストに入れる
type contextKeyCurrentUserID struct {}

func LoginHandler(w http.ResponseWriter, r *http.Request) {
	// ログイン処理の一部としてユーザーIDをセット
    currentUserID := r.URL.Query().Get("user_id")
    ctx := context.WithValue(r.Context(), contextKeyCurrentUserID, currentUserID)

	fmt.Fprintf(w, "User %s logged in\n", currentUserID)
}

### Q2
func main() {
	// contextに値をセット
	ctx := context.WithValue(context.Background(), "user_id", "12345")

	// 値を取得
	userID := ctx.Value("user_id").(string)
}

### A
名前衝突を避けるため、キーは文字列でなく空のstruct{}を使う
type contextKeyUserID struct{}

func main() {
	// contextに値をセット
	ctx := context.WithValue(context.Background(), contextKeyUserID, "12345")

	// 値を取得
	userID := ctx.Value(contextKeyUserID).(string)
}